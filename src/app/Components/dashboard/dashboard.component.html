<div class="container">
  <div class="row breadcrumb col-12 my-3">
    <ul class="breadcrumb m-0">
      <li>
        <a class="home" routerLink="/"
          ><i class="fa-solid fa-house-chimney"></i
        ></a>
      </li>
      <li><a routerLink="/dashboard">Dashboard</a></li>
    </ul>
  </div>

  <!-- <button
    type="button"
    class="btn btn-primary"
    data-toggle="modal"
    data-target="#exampleModal"
  >
    Launch demo modal
  </button> -->
  <div class="row d-flex justify-content-between align-items-center m-0">
    <button
      class="mb-3 add col-1"
      data-toggle="modal"
      data-target="#addProductModal"
    >
      <span>+ Add</span>
    </button>
    <div class="d-flex col-4 align-items-center m-0 p-0 mb-3">
      <label class="ms-3 me-2">Show:</label>
      <select
        #selectedNumber
        [(ngModel)]="itemsInPage"
        (change)="changeValue(+selectedNumber.value)"
        class="form-control"
        name="show"
        id="show"
      >
        <option value="12">12</option>
        <option value="16">16</option>
        <option value="20">20</option>
        <option value="24">24</option>
      </select>
    </div>
  </div>
  <div
    class="modal fade"
    id="addProductModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Add Product</h5>
          <button
            type="button"
            class="btn btn-danger rounded"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form
            [formGroup]="product"
            (ngSubmit)="save()"
            id="addproduct"
            class="w-100"
          >
            <div class="form-row d-flex gap-2 justify-content-between">
              <div class="form-group col-md-6">
                <label class="pb-2" for="productName">Product Name</label>
                <input
                  formControlName="name"
                  required
                  type="text"
                  class="form-control"
                  id="productName"
                  placeholder="Product Name"
                />
              </div>
              <div class="form-group col-md-6">
                <label class="pb-2" for="productID"
                  >Product ID
                  <span id="idExisted" class="alert alert-danger p-1"
                    >ID Already existed!</span
                  ></label
                >
                <input
                  formControlName="id"
                  type="number"
                  class="form-control"
                  id="productID"
                  placeholder="Product ID"
                />
              </div>
            </div>

            <div class="form-row d-flex gap-2 justify-content-between">
              <div class="form-group col-md-6">
                <label class="py-2" for="productQuantity">Quantity</label>
                <input
                  formControlName="quantity"
                  type="number"
                  class="form-control"
                  id="productQuantity"
                  placeholder="Quantity"
                />
              </div>
              <div class="form-group col-md-6">
                <label class="py-2" for="productPrice">Price</label>
                <input
                  formControlName="price"
                  type="number"
                  class="form-control"
                  id="productPrice"
                  placeholder="Price"
                />
              </div>
            </div>
            <div class="form-row">
              <label class="py-2" for="productDescription"
                >Product Description</label
              >
              <textarea
                formControlName="description"
                class="form-control"
                id="productDescription"
                placeholder="Product Description"
                rows="3"
              ></textarea>
            </div>
            <div class="form-row d-flex gap-2">
              <div class="form-group col-6">
                <label class="py-2" for="sellerName">Seller Name</label>
                <input
                  formControlName="seller"
                  type="text"
                  class="form-control"
                  id="sellerName"
                  placeholder="Seller Name"
                />
              </div>
              <div class="form-group col-6">
                <label class="py-2" for="category">Category</label>
                <select
                  formControlName="category"
                  id="category"
                  class="form-control"
                >
                  <option>cat</option>
                  <option>dog</option>
                  <option>rodents</option>
                  <option>bird</option>
                  <option>fish</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <label class="py-2" for="productImage">Product Image</label>
              <!-- <input
                formControlName="image"
                type="text"
                class="form-control"
                id="productImage"
                placeholder="Product Image Path or URL"
              /> -->
              <ngx-dropzone (change)="onSelect($event)" style="height: 20vh">
                <ngx-dropzone-label>Drag And Drop!</ngx-dropzone-label>
                <ngx-dropzone-preview
                  *ngFor="let f of files"
                  [removable]="true"
                  (removed)="onRemove(f)"
                >
                  <ngx-dropzone-label
                    >{{ f.name }} ({{ f.type }})</ngx-dropzone-label
                  >
                </ngx-dropzone-preview>
              </ngx-dropzone>
            </div>
          </form>
        </div>
        <div class="modal-footer d-flex justify-content-around w-100">
          <button
            #closebutton
            type="button"
            class="btn btn-dark col-5"
            data-dismiss="modal"
          >
            Close
          </button>
          <button
            [disabled]="product.invalid"
            form="addproduct"
            type="submit"
            class="btn btn-primary col-5"
          >
            Add Product
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL UPDATE  START-->
  <!-- MODAL UPDATE -->
  <div
    class="modal fade"
    id="updateProductModal"
    tabindex="-1"
    role="dialog"
    aria-labelledby="updateModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="updateModalLabel">Update Product</h5>
          <button
            type="button"
            class="btn btn-danger rounded"
            data-dismiss="modal"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <form
            [formGroup]="updatedProduct"
            (ngSubmit)="update()"
            id="updateproduct"
            class="w-100"
          >
            <div class="form-row d-flex gap-2 justify-content-between">
              <div class="form-group col-md-6">
                <label class="pb-2" for="productName">Product Name</label>
                <input
                  formControlName="name"
                  required
                  type="text"
                  class="form-control"
                  id="productName"
                />
              </div>
              <div class="form-group col-md-6">
                <label class="pb-2" for="productID">Product ID </label>
                <input
                  formControlName="id"
                  type="number"
                  class="form-control"
                  id="productID"
                />
              </div>
            </div>

            <div class="form-row d-flex gap-2 justify-content-between">
              <div class="form-group col-md-6">
                <label class="py-2" for="productQuantity">Quantity</label>
                <input
                  formControlName="quantity"
                  type="number"
                  class="form-control"
                  id="productQuantity"
                />
              </div>
              <div class="form-group col-md-6">
                <label class="py-2" for="productPrice">Price</label>
                <input
                  formControlName="price"
                  type="number"
                  class="form-control"
                  id="productPrice"
                />
              </div>
            </div>
            <div class="form-row">
              <label class="py-2" for="productDescription"
                >Product Description</label
              >
              <textarea
                formControlName="description"
                class="form-control"
                id="productDescription"
                rows="3"
              ></textarea>
            </div>
            <div class="form-row d-flex gap-2">
              <div class="form-group col-6">
                <label class="py-2" for="sellerName">Seller Name</label>
                <input
                  formControlName="seller"
                  type="text"
                  class="form-control"
                  id="sellerName"
                />
              </div>
              <div class="form-group col-6">
                <label class="py-2" for="category">Category</label>
                <select
                  formControlName="categories"
                  id="category"
                  class="form-control"
                >
                  <option>cat</option>
                  <option>dog</option>
                  <option>rodents</option>
                  <option>bird</option>
                  <option>fish</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <label class="py-2" for="productImage">Product Image</label>
              <input
                formControlName="image"
                type="text"
                class="form-control"
                id="productImage"
              />
            </div>
          </form>
        </div>
        <div class="modal-footer d-flex justify-content-around w-100">
          <button
            #closebuttonupdate
            type="button"
            class="btn btn-dark col-5"
            data-dismiss="modal"
          >
            Close
          </button>
          <button
            [disabled]="updatedProduct.invalid"
            form="updateproduct"
            type="submit"
            class="btn btn-primary col-5"
          >
            Apply Changes
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- MODAL UPDATE END -->
  <!-- MODAL UPDATE -->

  <div class="row">
    <div class="col-md-12">
      <div class="table-responsive text-center">
        <table class="table table-hover table-bordered" style="font-size: 1rem">
          <thead class="thead-dark">
            <tr>
              <th class="col-1">ID</th>
              <th class="col-1">Image</th>
              <th class="col-3">Name</th>
              <th class="col-1">Price</th>
              <th class="col-1 d-none d-lg-table-cell d-md-table-cell">
                Quantity
              </th>
              <th class="col-1 d-none d-lg-table-cell">Reviews</th>
              <th class="col-1 d-none d-lg-table-cell">Category</th>
              <th class="col-1 d-none d-lg-table-cell">Seller</th>
              <th class="col-1">Remove</th>
              <th class="col-1">Edit</th>
            </tr>
          </thead>
          <tbody>
            <!-- @for(product of Products; track product.id){ -->
            @if(Products){
            <tr
              *ngFor="
                let product of Products
                  | paginate
                    : {
                        id: 'pagination',
                        itemsPerPage: itemsInPage,
                        currentPage: page,
                        totalItems: total
                      }
              "
            >
              <td>
                <p>{{ product.id }}</p>
              </td>
              <td>
                <a routerLink="/product/{{ product.id }}"
                  ><img [src]="product.image" alt="Image"
                /></a>
              </td>
              <td>
                <a routerLink="/product/{{ product.id }}"
                  ><p>{{ product.name }}</p></a
                >
              </td>
              <td>
                <p>{{ product.price | currency : "EGP " }}</p>
              </td>
              <td class="col-1 d-none d-lg-table-cell d-md-table-cell">
                <p>{{ product.quantity }}</p>
              </td>
              <!--  -->
              <td class="d-none d-lg-table-cell">
                <p>{{ product.reviews }}</p>
              </td>
              <td class="d-none d-lg-table-cell">
                <p>{{ product.categories }}</p>
              </td>
              <td class="d-none d-lg-table-cell">
                <p>{{ product.seller }}</p>
              </td>
              <!--  -->
              <td>
                <button (click)="deleteProduct(product.id)">
                  <i class="fa fa-trash"></i>
                </button>
              </td>
              <td>
                <button
                  data-toggle="modal"
                  data-target="#updateProductModal"
                  (click)="updateProduct(product.id)"
                >
                  <i class="fa fa-edit"></i>
                </button>
              </td>
            </tr>
            }
            <!-- } -->
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
<div>
  <pagination-controls
    (pageChange)="changePage($event)"
    id="pagination"
    class="page-item d-flex justify-content-center mt-4"
  >
  </pagination-controls>
</div>
